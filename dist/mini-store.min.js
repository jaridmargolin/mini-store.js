!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.MiniStore=b()}(this,function(){var a,b,c,d,e,f,g,h,i,j,k;return a=function(a,b){var c;c=b.hasOwnProperty("constructor")?b.constructor:function(){return a.apply(this,arguments)};for(var d in a)c[d]=a[d];var e=function(){this.constructor=c};e.prototype=a.prototype,c.prototype=new e;for(var f in b)c.prototype[f]=b[f];return c},b=function(a){return a===Object(a)},c=function(a){return"[object Array]"===Object.prototype.toString.call(a)},d=function(a,b){var c=function(d,e){for(var f in e){var g=d[f]||{},h=e[f],i=b(h),j=a(h);i||j?(i&&!b(g)&&(d[f]={}),j&&!a(g)&&(d[f]=[]),d[f]=c(g,h)):d[f]=h}return d};return c}(c,b),e=function(a,b){return{isObject:a,deepMerge:b}}(b,d),f=function(a){var b=function(a){this.seperator=a||"."};return b.prototype.get=function(a,b){return this._get(a,b).val},b.prototype.set=function(b,c,d,e){var f=this._get(b,c,!0),g=f.val,h=f.parent,i=f.key,j=a.isObject(g)&&e;return h[i]=j?a.deepMerge(g,d):d,h[i]},b.prototype.remove=function(a,b){var c=this._get(a,b),d=c.parent,e=c.key;delete d[e]},b.prototype._get=function(a,b,c){for(var d=b.split(this.seperator),e=0,f=d.length;f>e;e++){var g=d[e],h=a[g],i=f===e+1,j=!h&&!c;if(i||j)return{key:g,val:h,parent:a};a=a[g]=h||{}}},b}(e),g=function(){var a=this,b=function(){this.events={}};return b.prototype.on=function(b,c,d){return(this.events[b]=this.events[b]||[]).unshift({fn:c,context:d||a}),this},b.prototype.off=function(a,b){var c=this.events[a]||[],d=c.length;if(a)if(b)for(;d--;)c[d].fn===b&&c.splice(d,1);else delete this.events[a];else this.events={};return this},b.prototype.trigger=function(a){for(var b=Array.prototype.slice.call(arguments,1),c=this.events[a]||[],d=c.length,e=[],f=0;d>f;f++)e.push(c[f]);for(;d--;)e[d].fn.apply(e[d].context,b);return this},b}(),h=function(a){return"undefined"==typeof a},i=function(a){return function(b){if(a(b))return 0===b.length;for(var c in b)if(b.hasOwnProperty(c))return!1;return!0}}(c),j=function(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])a[c]=arguments[b][c];return a},k=function(c){var d=a,e=f,k=g,l=h,m=b,n=i,o=j,p=new e(":");return d(k,{constructor:function(){k.prototype.constructor.apply(this,arguments),this.attributes={},arguments[0]&&this.set.apply(this,arguments)},set:function(a,b,c){var d=m(a);if(d&&(c=b,b=null),c=c||{},d?this._setProperties(a,c):this._setProperty(a,b,c),!c.silent&&!n(this.changed)){this.triggerMethod("change",this,c);for(var e in this.changed)this.triggerMethod("change:"+e,this,this.changed[e],c)}return this},_setProperties:function(a,b){var c={};for(var d in a)this._setProperty(d,a[d],b),o(c,this.changed);this.changed=c},_setProperty:function(a,b,c){this.changed={};var d=p._get(this.attributes,a,!0),e=a.split(":")[0];d.val!==b&&(p.set(d.parent,d.key,b,!c.flat),this.changed[e]=this.attributes[e])},unset:function(a,b){return b=b||{},this._unsetProperty(a),b.silent||n(this.changed)||this.triggerMethod("change",this,b),this},_unsetProperty:function(a){this.changed={};var b=a.split(":"),c=b[0],d=p._get(this.attributes,a,!0);l(d.val)||(p.remove(d.parent,d.key),b[1]?this.changed[c]=this.attributes[c]:this.changed[0]=a)},get:function(a){return a?this._getProperty(a):this.attributes},_getProperty:function(a){return p.get(this.attributes,a)},triggerMethod:function(a){for(var b=a.split(":"),c=0,d=b.length;d>c;c++)b[c]=b[c].charAt(0).toUpperCase()+b[c].substring(1);var e=this["on"+b.join("")];e&&e.apply(this,Array.prototype.slice.call(arguments,1)),this.trigger.apply(this,arguments)}})}({})});